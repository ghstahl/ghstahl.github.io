!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.src={})}(this,function(a){"use strict";function b(){return"http://localhost:8888/"}function c(){return"harvester"}function d(){return b()+"src/build/plugins/"+c()+"/styles/"+c()+".css"}function e(a){var b="https://wizardappapi.azurewebsites.net/api/RemoteJsonFile/open?file="+a;return ESPA.plugins.fetchService.fetch(b)}function f(a){return new Promise(function(b,c){b(a)})}function g(a){m=a,l.augmentViewData(k,m);var b=(m.wizardState,m.currentPageState);void 0===b.radioId&&(b.radioId=p[0].id,b.harvestUrl=p[0].value);ESPA.plugins.state.get();return Promise.all([ESPA.loadResource.css(d())]).then(function(a){m=Object.assign(m,{}),m.harvestRecords=p;var b=l.getBackPage(m);ESPA.plugins.wizardEngine.setCurrentState({backPage:b,currentPage:l,nextPage:"page-id-token",back:!!b,next:!0,cancel:!0,finish:!1}),h()}).catch(function(a){return ESPA.logger.error(a),Promise.reject({error:"_registerRouteCallback promise chain terminated"})})}function h(){var a=m.currentPageState;document.getElementById("loader").style.display="none",document.getElementById("wizard-content").innerHTML=ESPA.tmpl(n.factoryScope.tpl,m),document.getElementById("main-container").style.display="block";var b={};p.forEach(function(a){b["click #"+a.id]=i,console.log(a)}),ESPA.plugins.bindEvents(b),document.getElementById(a.radioId).checked=!0}function i(a){var b=m.currentPageState;b.radioId=a.srcElement.id,b.harvestUrl=a.srcElement.value}var j='<div class="container">\r\n    <h1 class="display-3">\r\n        Harvester\r\n    </h1>\r\n    <p>\r\n        <form id="my-harvest-form">\r\n            <% for ( var i = 0; i < harvestRecords.length; i++ ) { \r\n                var harvestRecord = harvestRecords[i];%>\r\n            <input id="<%= harvestRecord.id %>" type="radio" name="page" value="<%= harvestRecord.value %>">\r\n            <%= harvestRecord.label %><br>\r\n\r\n            <% } %>\r\n\r\n\r\n        </form>\r\n\r\n\r\n    </p>\r\n\r\n    \r\n    <p id="error"></p>\r\n\r\n\r\n\r\n</div>',k="page-harvest",l=ESPA.plugins.factoryWizardPage({getRouteName:function(){return k},onNext:function(){console.log("onNext");var a=m.currentPageState,b=ESPA.plugins.state.get().wizardState;return new Promise(function(c,d){e(a.harvestUrl).then(function(a){if(200==a.response.status){var d=a.json;return b.product_harvest=d,d}document.getElementById("error").innerHTML="harvest has been rejected!",c(!1)}).then(function(a){var d=a["wizard-package-url-dev"];d="http://localhost:8888/dist/espa/plugins/forest/1.0.0/main.js";var e=a["entry-page"];e="page-forest",ESPA.plugins.load(d).then(function(){ESPA.navigate(e,{directive:ESPA.plugins.wizardEngine.navigationDirective.Next,prevPage:"page-harvester",wizardState:b}),document.getElementById("loader").style.display="none"}),c(!0)}).catch(function(a){d(!1),console.log("There has been a problem with your fetch operation: ",a.message)})})},onBack:function(){return console.log("onBack"),f(!0)},onCancel:function(){return console.log("onCancel"),f(!0)}}),m=null,n={factoryScope:null,tpl:j,wizardPage:l,registerRouteCallback:g},o=l.makeFactory(n),p=[{id:"rad1",value:"harvest/product-instance-one.json",label:"Product One"},{id:"rad2",value:"harvest/product-instance-two.json",label:"Product Two"},{id:"rad3",value:"harvest/product-instance-three.json",label:"Product Three"}];o(),ESPA.plugins=ESPA.plugins||{},ESPA.plugins.env="prod",Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=main.min.js.map